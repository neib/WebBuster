#MAGENTO() {
    #=== Search for version ===
    echo "    + Search for Magento version"
    version_meta=$(grep -i '<meta name="generator"' "$TMP_HTML" | grep -i 'Magento' | grep -Eo 'content="[^"]+"' | head -n1 | cut -d\" -f2)

    if [[ "$version_meta" == *Magento* ]]; then
        echo "    + CMS version: $version_meta"
    else
        magento_version=$(curl "${CURLOPTIONS[@]}" "${BASE_URL}/magento_version" | head -n 5)

        if [[ -n "$magento_version" && "$magento_version" != *"404"* ]]; then
            echo -n "    + CMS version: "
            echo "$magento_version" | sed 's/^/      /'
        else
            echo "    - Version not detected"
        fi
    fi

    #=== Users ===
    echo "    + Users REST API check"
    users_json=$(curl "${CURLOPTIONS[@]}" "${BASE_URL}/rest/V1/customers/search?searchCriteria=")
    if echo "$users_json" | grep -q '"items"'; then
        echo "        + REST API exposing user data detected"
        echo "          > $users_json" | jq '.items[] | {id, email, firstname, lastname}' | head -n 5 | sed 's/^/          /'
    else
        echo "        - Users REST API not accessible or empty"
    fi

    #=== Modules ===
    echo "    + Search for exposed modules/add-ons"
    declare -a modules=(
        "Magento_Customer"
        "Magento_Checkout"
        "Magento_AdminNotification"
    )
    for mod in "${modules[@]}"; do
        mod_path="${BASE_URL}/static/adminhtml/${mod}/"
        mod_status=$(curl "${CURLOPTIONS[@]}" -o /dev/null -w "%{http_code}" "$mod_path")
        if [[ "$mod_status" == "200" ]]; then
            echo "          + Module detected: $mod"
        fi
    done

    #=== Common paths ===
    declare -a CMS_PATHS=(
        "/downloader"
        "/LICENSE.txt"
        "/README.txt"
    )
    #=== Sensitive files ===
    declare -a SENSITIVE_FILES=(
        "/pub/errors/local.xml"
        "/errors/503.html"
        "/static/adminhtml"
    )
    #=== Admin panel ===
    declare -a ADMIN_PATHS=(
        "/admin"
    )
    #=== Directories ===
    declare -a DIRS=(
        "/pub/static/"
        "/static/adminhtml/"
        "/var/report/"
    )
    #=== Known RCE ===
    declare -a RCE_FILES=(
        "/index.php/admin"                                   # Default admin path potentially vulnerable depending on version
        "/js/mage/adminhtml/backup.js"                       # Admin scripts potentially vulnerable
        "/js/mage/adminhtml/logger.js"                       # Vulnerable script that may expose actions
        "/downloader/index.php"                              # Vulnerable legacy Composer/Installer
        "/errors/processor.php"                              # Error file vulnerable to RCE in certain versions
        "/dev/tests/functional/index.php"                    # Test scripts sometimes publicly accessible
        "/lib/internal/Magento/Framework/App/FrontController.php" # Core vulnerable in older versions
        "/app/code/Magento/Adminhtml/Controller/Backup.php" # Vulnerable backup file execution
        "/lib/internal/Magento/Framework/DB/Adapter/Pdo/Mysql.php" # RCE possible in injection if accessible
        "/phpinfo.php"                                       # Often uploaded by mistake and dangerous
    )
#}
